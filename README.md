Done some work in updating icons according to conditions
